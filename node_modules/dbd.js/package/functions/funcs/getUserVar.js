const getUserVar = async d => {

	const code = d.command.code

	const r = code.split("$getUserVar").length - 1

	const inside = code.split("$getUserVar[")[r].split("]")[0]

	let [variable, userID = d.message.author.id, guildID] = inside.split(";")
	
	if (!guildID) guildID = d.message.guild ? d.message.guild.id : "" 
	
	if (d.client.variables[variable] === undefined) return d.error(`:x: Variable '${variable}' not found!`)

	let item = await d.client.db.findOne({
		variable: variable,
		varID: `${guildID}_${userID}`
	})

	if (!item)
		item = { value: d.client.variables[variable] }

	item = item.value

	return {
		code: code.replaceLast(`$getUserVar[${inside}]`, item)
	}
}

module.exports = getUserVar